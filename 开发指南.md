# AI网页助手 Chrome扩展开发指南

## 开发环境设置

### 1. 安装Node.js和npm

如果您尚未安装Node.js和npm，请从[Node.js官网](https://nodejs.org/)下载并安装最新的LTS版本。

### 2. 安装项目依赖

在项目根目录下运行以下命令安装所需的依赖：

```bash
npm install
```

## 开发流程

### 1. 构建扩展

开发模式（监视文件变化并自动重新构建）：

```bash
npm run dev
```

生产模式（一次性构建）：

```bash
npm run build
```

构建后的文件将位于`dist`目录中。

### 2. 在Chrome中加载扩展

1. 打开Chrome浏览器
2. 访问`chrome://extensions/`
3. 开启右上角的"开发者模式"
4. 点击"加载已解压的扩展程序"
5. 选择项目的`dist`目录

## 项目结构说明

- `manifest.json`: 扩展的配置文件
- `background.js`: 背景脚本，处理API调用和消息传递
- `content/`: 内容脚本和样式，负责在网页中注入侧边栏
  - `content.js`: 主要内容脚本
  - `styles.css`: 侧边栏样式
  - `sidebar.html`: 侧边栏HTML
- `popup/`: 点击扩展图标时显示的弹出窗口
  - `popup.html`: 弹出窗口HTML
  - `popup.css`: 弹出窗口样式
  - `popup.js`: 弹出窗口脚本
- `options/`: 扩展设置页面
  - `options.html`: 设置页面HTML
  - `options.css`: 设置页面样式
  - `options.js`: 设置页面脚本
- `lib/`: 库文件
  - `api.js`: AI API调用函数
- `assets/`: 资源文件
  - `icons/`: 图标文件

## 开发注意事项

### 1. API密钥安全

- 不要在代码中硬编码API密钥
- 使用Chrome存储API安全地存储用户提供的API密钥
- 提醒用户保护他们的API密钥

### 2. 内容脚本权限

- 内容脚本只能访问它被注入的网页的DOM
- 使用消息传递与背景脚本通信
- 注意跨域限制

### 3. 侧边栏UI

- 确保侧边栏不会干扰网页的正常功能
- 提供关闭和最小化选项
- 考虑响应式设计，适应不同屏幕尺寸

### 4. 性能优化

- 避免在内容脚本中进行大量计算
- 优化网页内容提取算法
- 考虑缓存机制减少API调用

## 调试技巧

1. 背景脚本调试：在扩展管理页面点击"背景页"链接
2. 内容脚本调试：在网页上右键点击，选择"检查"，然后在控制台中查看
3. 弹出窗口调试：右键点击弹出窗口，选择"检查"

## 发布准备

1. 在`manifest.json`中更新版本号
2. 运行`npm run build`生成生产版本
3. 压缩`dist`目录中的文件为ZIP格式
4. 在[Chrome开发者控制台](https://chrome.google.com/webstore/devconsole/)上传扩展包

## 常见问题解决

### 扩展无法加载

- 检查`manifest.json`是否有语法错误
- 确保所有必要的文件都已包含在`dist`目录中
- 检查控制台是否有错误消息

### API调用失败

- 验证API密钥是否正确
- 检查网络请求是否被阻止
- 确认API端点URL是否正确

### 侧边栏不显示

- 检查内容脚本是否正确注入
- 验证CSS样式是否正确应用
- 检查控制台是否有错误消息
